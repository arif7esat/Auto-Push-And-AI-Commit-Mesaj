#!/bin/bash

# AutoPush - Ana Kontrol Scripti
# KullanÄ±m: ./autopush [start|stop|status|restart]
# Mevcut dizindeki .git repository ile Ã§alÄ±ÅŸÄ±r

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SCRIPTS_DIR="$SCRIPT_DIR/autopush-scripts"

# Scripts klasÃ¶rÃ¼ var mÄ± kontrol et
if [ ! -d "$SCRIPTS_DIR" ]; then
    echo "âŒ HATA: autopush-scripts klasÃ¶rÃ¼ bulunamadÄ±!"
    exit 1
fi

# Mevcut dizinde .git'i kontrol et
if [ ! -d ".git" ]; then
    echo "âŒ HATA: Bu dizinde .git repository bulunamadÄ±!"
    echo "Mevcut dizin: $SCRIPT_DIR"
    exit 1
fi

echo "ğŸ“ Git repository dizini: $SCRIPT_DIR"

case "$1" in
    start)
        echo "AutoPush baÅŸlatÄ±lÄ±yor..."
        "$SCRIPTS_DIR/start_autopush.sh"
        ;;
    stop)
        echo "AutoPush durduruluyor..."
        "$SCRIPTS_DIR/stop_autopush.sh"
        ;;
    status)
        "$SCRIPTS_DIR/status_autopush.sh"
        ;;
    restart)
        echo "AutoPush yeniden baÅŸlatÄ±lÄ±yor..."
        "$SCRIPTS_DIR/stop_autopush.sh"
        sleep 2
        "$SCRIPTS_DIR/start_autopush.sh"
        ;;
    *)
        echo "AutoPush - Basit Otomatik Git Push Sistemi"
        echo ""
        echo "KullanÄ±m: $0 [start|stop|status|restart]"
        echo ""
        echo "Komutlar:"
        echo "  start   - AutoPush'Ä± baÅŸlat"
        echo "  stop    - AutoPush'Ä± durdur"
        echo "  status  - Durumu kontrol et"
        echo "  restart - AutoPush'Ä± yeniden baÅŸlat"
        echo ""
        echo "Ã–zellikler:"
        echo "  - 10 dakikada bir otomatik push"
        echo "  - Backup branch'e push yapar"
        echo "  - Arka planda Ã§alÄ±ÅŸÄ±r"
        echo "  - Terminal kapansa bile Ã§alÄ±ÅŸmaya devam eder"
        echo "  - Log tutar (program_log)"
        echo "  - PID bilgisini saklar (autopush.pid)"
        echo "  - Mevcut dizindeki .git ile Ã§alÄ±ÅŸÄ±r"
        echo ""
        echo "Git Repository: $SCRIPT_DIR"
        ;;
esac
